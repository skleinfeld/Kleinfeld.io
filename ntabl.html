---
layout: default
title: North Texas Amateur Baseball League | Interactive Hitting Stats
permalink: /ntabl/
---

<section id="ntabl-page" class="wrap-wide" style="padding:40px 0;">
  <h1 style="font-size:22px;font-weight:700;margin:0 0 18px">
    North Texas Amateur Baseball League | Interactive Hitting Stats
  </h1>

  <!-- Controls -->
  <div class="card ntabl-controls">
    <div class="ntabl-field">
      <label for="f-year">Year</label>
      <select id="f-year" class="ntabl-select"></select>
    </div>
    <div class="ntabl-field">
      <label for="f-season">Season</label>
      <select id="f-season" class="ntabl-select"></select>
    </div>
    <div class="ntabl-field">
      <label for="f-program">Program</label>
      <select id="f-program" class="ntabl-select"></select>
    </div>
    <div class="ntabl-field">
      <label for="f-team">Team</label>
      <select id="f-team" class="ntabl-select"></select>
    </div>
    <div class="ntabl-field">
      <label for="f-player">Player</label>
      <select id="f-player" class="ntabl-select"></select>
    </div>

    <div class="ntabl-actions">
      <button id="btn-clear-player" class="ntabl-control-btn alt" type="button">Clear Player</button>
      <button id="btn-reset" class="ntabl-control-btn" type="button">Reset Filters</button>
    </div>
  </div>

  <!-- Table -->
  <div class="surface ntabl-surface">
    <div class="ntabl-wrap">
      <table id="ntabl-table" class="ntabl-table" aria-describedby="ntabl-note">
        <thead></thead>
        <tbody></tbody>
        <tfoot></tfoot>
      </table>
    </div>
    <div id="ntabl-note" class="ntabl-note">
      Hover to highlight row &amp; column. Click a player name to filter to that player. Click headers to sort.
    </div>
  </div>
</section>

<!-- PapaParse -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
/* PAGE OVERRIDES: let this page go wide no matter what global .wrap-wide does */
#ntabl-page{ max-width:none !important; width:100%; }

/* ========= Width & theme variables ========= */
:root{
  /* WIDER so every column (through ROE) fits without horizontal scroll */
  --ntabl-width: 2040px;

  /* width for each numeric/stat column */
  --ntabl-number-col: 54px;

  --ntabl-text: #e7eaee;
  --ntabl-muted: #a5adb6;
  --ntabl-head-bg: #0d0f12;
  --ntabl-head-hover: #1f2430;
  --ntabl-cell: #ffffff;
  --ntabl-row-hover: #eef2f7;
  --ntabl-col-hover: #e6eaf1;
  --ntabl-border: #e9eef5;
  --ntabl-sticky-border: #2b2f35;

  /* control sizing (selects & buttons will match) */
  --control-minw: 170px;
  --control-pad-v: 10px;
  --control-pad-h: 12px;
  --control-radius: 12px;
  --control-font: 14px;
  --control-weight: 600;
}

/* ========= Controls layout ========= */
.ntabl-controls{
  margin:0 auto 16px;
  padding:16px;
  display:flex;
  flex-wrap:wrap;
  gap:12px 16px;
  align-items:end;
  max-width:var(--ntabl-width); /* match table width */
}
.ntabl-field{ display:flex; flex-direction:column; gap:6px; }
.ntabl-field label{ font-size:12px; color:var(--ntabl-muted); }

.ntabl-select{
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  background:#0f1113; color:#e9eaec;
  border:1px solid #222428; border-radius:var(--control-radius);
  padding:var(--control-pad-v) var(--control-pad-h);
  min-width:var(--control-minw); font-weight:var(--control-weight); font-size:var(--control-font);
}
.ntabl-select:focus{ outline:none; border-color:#2b2f35; box-shadow:0 0 0 3px rgba(124,58,237,.28) }

.ntabl-actions{ margin-left:auto; display:flex; gap:12px; }
.ntabl-control-btn{
  background:#0f1113; color:#e9eaec;
  border:1px solid #222428; border-radius:var(--control-radius);
  padding:var(--control-pad-v) var(--control-pad-h);
  min-width:var(--control-minw); font-weight:var(--control-weight); font-size:var(--control-font);
  cursor:pointer;
}
.ntabl-control-btn:hover{ border-color:#2b2f35; box-shadow:0 0 0 3px rgba(124,58,237,.18) }
.ntabl-control-btn.alt{
  background:linear-gradient(180deg,#2f3541,#20242c);
}

/* ========= Table sizing & look ========= */
.ntabl-surface{ margin:0 auto; max-width:var(--ntabl-width); } /* same width as controls */
.ntabl-wrap{ overflow-x:hidden; } /* no horizontal scroll */
.ntabl-table{
  width:100%;
  border-collapse:separate; border-spacing:0;
  font-size:14px; line-height:1.25;
  table-layout:fixed; /* static/fixed column widths */
}
.ntabl-table thead th{
  background:var(--ntabl-head-bg); color:var(--ntabl-text);
  border-bottom:1px solid var(--ntabl-sticky-border);
  padding:10px 10px;
  position:sticky; top:0; z-index:1;
  text-align:center;
}
.ntabl-table thead th.t-text{ text-align:left; padding-left:12px; }
.ntabl-table tbody td, .ntabl-table tfoot td, .ntabl-table tfoot th{
  background:var(--ntabl-cell); color:#0f1113;
  padding:9px 10px; border-bottom:1px solid var(--ntabl-border);
  text-align:center; /* center stats */
}
.ntabl-table tbody td.t-text, .ntabl-table tfoot th.t-text{ text-align:left; padding-left:12px; }
.ntabl-table tbody tr:hover td{ background:var(--ntabl-row-hover) !important; }

/* fixed widths for the first text columns (sum ~ 658px) */
th[data-col="PLAYER"], td[data-col="PLAYER"]{ width:190px; }
th[data-col="YEAR"],   td[data-col="YEAR"]  { width:72px; }
th[data-col="SEASON"], td[data-col="SEASON"]{ width:96px; }
th[data-col="PROGRAM"],td[data-col="PROGRAM"]{ width:140px; }
th[data-col="TEAM"],   td[data-col="TEAM"]  { width:160px; }

/* all numeric/stat columns share the same width */
.ntabl-table .t-num{ width:var(--ntabl-number-col); }

/* column hover highlight (x & y), keeping header readable */
.ntabl-table thead th.col-hover{ background:var(--ntabl-head-hover) !important; color:#fff; }
.ntabl-table tbody td.col-hover,
.ntabl-table tfoot td.col-hover{ background:var(--ntabl-col-hover) !important; }

/* Player link visuals */
.link-like{
  background:none;border:none;color:#1e40af;cursor:pointer;padding:0;
  font:inherit; font-weight:700;
}
.link-like:hover{
  color:#0e7490;
  text-decoration:underline dotted;
  text-underline-offset:2px;
}

/* footnote */
.ntabl-note{ font-size:12px;color:#667085;padding:10px 12px 14px }
</style>

<script>
(function(){
  const CSV_PATH = "/ntabl-hitting-stats.csv";

  // front columns (exact order you want)
  const FRONT = ['PLAYER','YEAR','SEASON','PROGRAM','TEAM'];

  // stat columns in preferred order
  const STATS_ORDER = [
    'GP','PA','AB','R','H','1B','2B','3B','HR','RBI','BB','HBP','SO','K-L','SB','TB',
    'AVG','OBP','SLG','OPS','SF','SAC','ROE'
  ];

  const METRICS = new Set(['AVG','OBP','SLG','OPS']);
  const TEXT_COLS = new Set(['PLAYER','YEAR','SEASON','PROGRAM','TEAM']);

  const ORDER_YEAR   = ['2025','2024'];
  const ORDER_SEASON = ['Summer','Fall','Spring'];

  const table   = document.getElementById('ntabl-table');
  const theadEl = table.querySelector('thead');
  const tbodyEl = table.querySelector('tbody');
  const tfootEl = table.querySelector('tfoot');

  const fYear    = document.getElementById('f-year');
  const fSeason  = document.getElementById('f-season');
  const fProgram = document.getElementById('f-program');
  const fTeam    = document.getElementById('f-team');
  const fPlayer  = document.getElementById('f-player');

  const btnReset       = document.getElementById('btn-reset');
  const btnClearPlayer = document.getElementById('btn-clear-player');

  let rows = [];
  let viewRows = [];
  let COLS = [];
  let sortKey = null;
  let sortDir = 1;

  const numLike= v => v!=='' && v!==null && !isNaN(v);
  const to3    = v => Number(v).toFixed(3).replace(/^0/,'');

  function setOptions(sel, list, labelAll){
    sel.innerHTML='';
    const all=document.createElement('option'); all.value=''; all.textContent=labelAll; sel.appendChild(all);
    list.forEach(v=>{ const o=document.createElement('option'); o.value=v; o.textContent=v; sel.appendChild(o); });
  }

  function totalsFor(rows, cols){
    const t={}; cols.forEach(c=>t[c]=TEXT_COLS.has(c)?'':0);
    rows.forEach(r=>{
      cols.forEach(c=>{
        if(TEXT_COLS.has(c) || METRICS.has(c)) return;
        if(numLike(r[c])) t[c]+= (+r[c]||0);
      });
    });
    return t;
  }

  function compare(a,b,k){
    const av=a[k], bv=b[k];
    const an=numLike(av), bn=numLike(bv);
    if(an&&bn) return (av-bv)*sortDir;
    return String(av??'').localeCompare(String(bv??''))*sortDir;
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  function buildHead(){
    theadEl.innerHTML = '<tr>'+COLS.map(c=>{
      const cls = TEXT_COLS.has(c)?'t-text':'t-num';
      const arrow = (sortKey===c)?(sortDir>0?' ▲':' ▼'):'';
      return `<th data-col="${c}" class="${cls}" style="cursor:pointer" title="Sort by ${c}">${c}${arrow}</th>`;
    }).join('')+'</tr>';

    theadEl.querySelectorAll('th').forEach((th, idx)=>{
      th.addEventListener('click',()=>{
        const k = th.getAttribute('data-col');
        if(sortKey===k) sortDir*=-1; else { sortKey=k; sortDir=1; }
        renderBody();
        buildHead(); // refresh arrows
      });
      th.setAttribute('data-col-idx', idx);
    });
  }

  function buildBodyRows(data){
    return data.map(r=>{
      return '<tr>'+COLS.map((c,idx)=>{
        let v = r[c] ?? '';
        if(METRICS.has(c) && numLike(v)) v = to3(v);
        if(c==='PLAYER' && v){
          v = `<button class="link-like player-link" data-player="${escapeHtml(String(v))}" title="Filter to ${escapeHtml(String(v))}">${escapeHtml(String(v))}</button>`;
        }
        const cls = TEXT_COLS.has(c)?'t-text':'t-num';
        return `<td class="${cls}" data-col="${c}" data-col-idx="${idx}">${v}</td>`;
      }).join('')+'</tr>';
    }).join('');
  }

  function renderBody(){
    let data = viewRows.slice();
    if(sortKey){ data.sort((a,b)=>compare(a,b,sortKey)); }
    tbodyEl.innerHTML = buildBodyRows(data);

    const t = totalsFor(data, COLS);
    tfootEl.innerHTML = '<tr>'+COLS.map((c,i)=>{
      if(i===0) return '<th scope="row" class="t-text">Totals</th>';
      const cls = TEXT_COLS.has(c)?'t-text':'t-num';
      return `<td class="${cls}" data-col="${c}">${numLike(t[c])?t[c]:''}</td>`;
    }).join('')+'</tr>';

    // player-click filtering
    tbodyEl.querySelectorAll('.player-link').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const p = btn.getAttribute('data-player');
        fPlayer.value = p;      // keep dropdown in sync
        applyFilters();
      });
    });
  }

  // column hover highlight (x & y), keeping header readable
  function markColumn(idx, on){
    const selector = `td[data-col-idx="${idx}"]`;
    tbodyEl.querySelectorAll(selector).forEach(td=>td.classList.toggle('col-hover', on));
    const head = theadEl.querySelector(`th[data-col-idx="${idx}"]`);
    if(head) head.classList.toggle('col-hover', on);
    const tf = tfootEl.querySelectorAll('td')[idx-1];
    if(tf) tf.classList.toggle('col-hover', on);
  }
  tbodyEl.addEventListener('mouseover', (e)=>{
    const cell = e.target.closest('td'); if(!cell) return;
    const idx = +cell.getAttribute('data-col-idx'); if(isNaN(idx)) return;
    markColumn(idx, true);
  });
  tbodyEl.addEventListener('mouseout', (e)=>{
    const cell = e.target.closest('td'); if(!cell) return;
    const idx = +cell.getAttribute('data-col-idx'); if(isNaN(idx)) return;
    markColumn(idx, false);
  });

  function applyFilters(){
    const y = fYear.value;
    const s = fSeason.value;
    const p = fProgram.value;
    const t = fTeam.value;
    const pl = fPlayer.value;

    viewRows = rows.filter(r=>{
      if(pl && String(r['PLAYER'])!==pl) return false;
      if(y && String(r['YEAR'])!==y) return false;
      if(s && String(r['SEASON'])!==s) return false;
      if(p && String(r['PROGRAM'])!==p) return false;
      if(t && String(r['TEAM'])!==t) return false;
      return true;
    });
    btnClearPlayer.style.visibility = pl ? 'visible' : 'hidden';
    renderBody();
  }

  function resetFilters(){
    fYear.value=''; fSeason.value=''; fProgram.value=''; fTeam.value=''; fPlayer.value='';
    btnClearPlayer.style.visibility = 'hidden';
    applyFilters();
  }
  document.getElementById('btn-reset').addEventListener('click', resetFilters);
  btnClearPlayer.addEventListener('click', ()=>{ fPlayer.value=''; applyFilters(); });

  Papa.parse(CSV_PATH, {
    download:true, header:true, dynamicTyping:true, skipEmptyLines:'greedy',
    complete: res => {
      const raw = res.data || [];

      rows = raw.map(r=>{
        const o={};
        Object.keys(r).forEach(k=>{ o[String(k).toUpperCase()] = r[k]; });
        o['PLAYER']  = (o['PLAYER']  ?? '').toString().trim();
        o['YEAR']    = (o['YEAR']    ?? '').toString().trim();
        o['SEASON']  = (o['SEASON']  ?? '').toString().trim();
        o['PROGRAM'] = (o['PROGRAM'] ?? '').toString().trim();
        o['TEAM']    = (o['TEAM']    ?? '').toString().trim();
        if(o['K_L'] !== undefined && o['K-L'] === undefined) o['K-L'] = o['K_L'];
        return o;
      });

      // Build column list: front + present stats + any extras
      const present = new Set(); rows.forEach(r=>Object.keys(r).forEach(k=>present.add(k)));
      const stats = STATS_ORDER.filter(c=>present.has(c));
      const rest  = Array.from(present).filter(c=>!FRONT.includes(c) && !stats.includes(c));
      COLS = [...FRONT, ...stats, ...rest];

      buildHead();

      const years    = Array.from(new Set(rows.map(r=>r['YEAR']).filter(Boolean)))
        .sort((a,b)=>ORDER_YEAR.indexOf(a)-ORDER_YEAR.indexOf(b) || b.localeCompare(a));
      const seasons  = Array.from(new Set(rows.map(r=>r['SEASON']).filter(Boolean)))
        .sort((a,b)=>ORDER_SEASON.indexOf(a)-ORDER_SEASON.indexOf(b) || a.localeCompare(b));
      const programs = Array.from(new Set(rows.map(r=>r['PROGRAM']).filter(Boolean))).sort();
      const teams    = Array.from(new Set(rows.map(r=>r['TEAM']).filter(Boolean))).sort();
      const players  = Array.from(new Set(rows.map(r=>r['PLAYER']).filter(Boolean))).sort();

      function setOptions(sel, list, label){
        sel.innerHTML='';
        const all=document.createElement('option'); all.value=''; all.textContent=label; sel.appendChild(all);
        list.forEach(v=>{ const o=document.createElement('option'); o.value=v; o.textContent=v; sel.appendChild(o); });
      }

      setOptions(fYear, years, 'All Years');
      setOptions(fSeason, seasons, 'All Seasons');
      setOptions(fProgram, programs, 'All Programs');
      setOptions(fTeam, teams, 'All Teams');
      setOptions(fPlayer, players, 'All Players');
      btnClearPlayer.style.visibility = 'hidden';

      viewRows = rows.slice();
      renderBody();

      fYear.addEventListener('change', applyFilters);
      fSeason.addEventListener('change', applyFilters);
      fProgram.addEventListener('change', applyFilters);
      fTeam.addEventListener('change', applyFilters);
      fPlayer.addEventListener('change', applyFilters);
    },
    error: err => {
      theadEl.innerHTML = '<tr><th>Error</th></tr>';
      tbodyEl.innerHTML = `<tr><td style="padding:12px 14px;color:#c00">Unable to load CSV (${err?.message||'unknown error'}). Check <code>${CSV_PATH}</code>.</td></tr>`;
      tfootEl.innerHTML = '';
    }
  });
})();
</script>